<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://cdn.pubnub.com/sdk/javascript/pubnub.4.0.8.js"></script>
    <meta charset="UTF-8">
    <title>Simple Chat</title>
    <link rel="stylesheet" href="layout.css"/>

    <style type="text/css">
        body, input, button { font-size: 100%; }
        body {
            font-size: 300%;
        }

        #history { border: 1px solid black;}
        #history, #message { border: 1px solid black;}


    </style>
</head>
<body>

<div class="fill vbox">
    <div id="history" class="grow scroll"></div>
    <input id="message"/>
</div>

<script type="text/javascript">
    // a simple JQuery like function to get elements by ID
    function $(id) { return document.getElementById(id);  }

    //configure pubnub
    var pubnub = new PubNub({
        subscribeKey:"sub-c-de6d91ce-aeb2-11e6-b697-0619f8945a4f",
        publishKey:"pub-c-d33f9c31-0856-440a-9b0b-a045c16998ea"
    });

    //add listener for message events
    pubnub.addListener({
        message: function(evt) {
            $('history').innerHTML += "<p>"+evt.message.text+"</p>"
            $('history').scrollTop = $('history').scrollHeight;
        }
    });
    //subscribe to channel
    pubnub.subscribe({channels:['request.message.channel']});

    //send the message
    $('message').addEventListener('keypress',function(evt) {
        if(evt.keyCode == 13) { //enter key
            pubnub.publish({
                channel:'request.message.channel',
//                channel:'chatbot-translate',
                message:{text: $('message').value}
            });
            $('message').value = '';
            $('message').focus();
        }
    });
    $('message').focus();
</script>
</body>
</html>
